<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test CRUD Mahasiswa</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 10px 15px; margin: 5px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer; }
        button:hover { background: #0056b3; }
        .result { margin-top: 10px; padding: 10px; background: #f8f9fa; border-radius: 3px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        input, select { padding: 5px; margin: 5px; width: 200px; }
    </style>
</head>
<body>
    <h1>Test CRUD Mahasiswa</h1>
    
    <div class="test-section">
        <h3>1. Test GET - Ambil Semua Data</h3>
        <button onclick="getAllMahasiswa()">Get All Mahasiswa</button>
        <div id="getResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>2. Test POST - Tambah Mahasiswa Baru</h3>
        <input type="text" id="nim" placeholder="NIM" value="2024011">
        <input type="text" id="nama" placeholder="Nama Lengkap" value="Test Mahasiswa">
        <input type="text" id="fakultas" placeholder="Fakultas" value="Fakultas Test">
        <input type="text" id="prodi" placeholder="Program Studi" value="Prodi Test">
        <input type="number" id="angkatan" placeholder="Angkatan" value="2024">
        <select id="status">
            <option value="aktif">Aktif</option>
            <option value="cuti">Cuti</option>
            <option value="lulus">Lulus</option>
            <option value="nonaktif">Nonaktif</option>
        </select>
        <input type="email" id="email" placeholder="Email" value="test@email.com">
        <br>
        <button onclick="addMahasiswa()">Tambah Mahasiswa</button>
        <div id="addResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>3. Test PUT - Update Mahasiswa</h3>
        <input type="number" id="updateId" placeholder="ID Mahasiswa" value="1">
        <input type="text" id="updateNim" placeholder="NIM" value="2024001">
        <input type="text" id="updateNama" placeholder="Nama Lengkap" value="Ahmad Fadillah Updated">
        <input type="text" id="updateFakultas" placeholder="Fakultas" value="Fakultas Teknik">
        <input type="text" id="updateProdi" placeholder="Program Studi" value="Teknik Informatika">
        <input type="number" id="updateAngkatan" placeholder="Angkatan" value="2024">
        <select id="updateStatus">
            <option value="aktif">Aktif</option>
            <option value="cuti">Cuti</option>
            <option value="lulus">Lulus</option>
            <option value="nonaktif">Nonaktif</option>
        </select>
        <input type="email" id="updateEmail" placeholder="Email" value="ahmad.updated@email.com">
        <br>
        <button onclick="updateMahasiswa()">Update Mahasiswa</button>
        <div id="updateResult" class="result"></div>
    </div>

    <div class="test-section">
        <h3>4. Test DELETE - Hapus Mahasiswa</h3>
        <input type="number" id="deleteId" placeholder="ID Mahasiswa" value="1">
        <button onclick="deleteMahasiswa()">Hapus Mahasiswa</button>
        <div id="deleteResult" class="result"></div>
    </div>

    <script>
        function showResult(elementId, data, isSuccess = true) {
            const element = document.getElementById(elementId);
            element.innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            element.className = 'result ' + (isSuccess ? 'success' : 'error');
        }

        function getAllMahasiswa() {
            fetch('api/mahasiswa_crud.php')
                .then(response => response.json())
                .then(data => {
                    showResult('getResult', data, data.status === 'success');
                })
                .catch(error => {
                    showResult('getResult', { error: error.message }, false);
                });
        }

        function addMahasiswa() {
            const data = {
                nim: document.getElementById('nim').value,
                nama_lengkap: document.getElementById('nama').value,
                fakultas: document.getElementById('fakultas').value,
                program_studi: document.getElementById('prodi').value,
                angkatan: parseInt(document.getElementById('angkatan').value),
                status: document.getElementById('status').value,
                email: document.getElementById('email').value
            };

            fetch('api/mahasiswa_crud.php', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                showResult('addResult', data, data.status === 'success');
                if (data.status === 'success') {
                    getAllMahasiswa(); // Refresh data
                }
            })
            .catch(error => {
                showResult('addResult', { error: error.message }, false);
            });
        }

        function updateMahasiswa() {
            const data = {
                id: parseInt(document.getElementById('updateId').value),
                nim: document.getElementById('updateNim').value,
                nama_lengkap: document.getElementById('updateNama').value,
                fakultas: document.getElementById('updateFakultas').value,
                program_studi: document.getElementById('updateProdi').value,
                angkatan: parseInt(document.getElementById('updateAngkatan').value),
                status: document.getElementById('updateStatus').value,
                email: document.getElementById('updateEmail').value
            };

            fetch('api/mahasiswa_crud.php', {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
            .then(response => response.json())
            .then(data => {
                showResult('updateResult', data, data.status === 'success');
                if (data.status === 'success') {
                    getAllMahasiswa(); // Refresh data
                }
            })
            .catch(error => {
                showResult('updateResult', { error: error.message }, false);
            });
        }

        function deleteMahasiswa() {
            const id = parseInt(document.getElementById('deleteId').value);

            fetch('api/mahasiswa_crud.php', {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ id: id })
            })
            .then(response => response.json())
            .then(data => {
                showResult('deleteResult', data, data.status === 'success');
                if (data.status === 'success') {
                    getAllMahasiswa(); // Refresh data
                }
            })
            .catch(error => {
                showResult('deleteResult', { error: error.message }, false);
            });
        }

        // Load data saat halaman dimuat
        window.onload = function() {
            getAllMahasiswa();
        };
    </script>
</body>
</html> 